---
id: 42
title: Boogie Board Rip on Linux
date: 2012-01-14T22:49:03+00:00
author: mark
excerpt: |
  I'm fed up of making notes on scrappy bits of paper that I lose, so with some money I got for Christmas I got myself a <a href="http://www.amazon.co.uk/gp/product/B005ZPZ5XW/ref=as_li_qf_sp_asin_il_tl?ie=UTF8&tag=barrfrozwast-21&linkCode=as2&camp=1634&creative=6738&creativeASIN=B005ZPZ5XW">Boogie Board Rip</a>.  I'm not going to do a full-blown review here, but essentially it's an etch-a-sketch on top of a portable graphics tablet.  The graphics tablet bit is battery powered, and converts what you draw to PDF.  The PDFs can be accessed by plugging the board into a PC via a Micro USB cable. Some people complain that it's not very good for drawing, but I only wanted it for writing and it's great for that.
  
  After using the board for a couple of days, it turns out that as well as appearing as a USB storage device when plugged in, it also appears as a human interface device and spits out a stream of binary (32 bytes of it to be exact) for each event that occurs on the device (button presses, movement of the stylus, etc).  With a bit of help from the aforementioned blog post I've managed to decode the binary and write a short Ruby script that reports what's happened each time you do something.
  
  The script as it stands at time of posting is shown below. The latest version is available on <a href="https://github.com/marxjohnson/rubyboard">github</a>.
  
  <pre style='color:#d1d1d1;background:#000000;'>begin
  lsusb <span style='color:#d2cd86; '>=</span> `lsusb`
  <span style='color:#e66170; font-weight:bold; '>if</span> lsusb<span style='color:#d2cd86; '>.</span>split<span style='color:#d2cd86; '>(</span><span style='color:#02d045; '>"</span><span style='color:#008080; '>\n</span><span style='color:#02d045; '>"</span><span style='color:#d2cd86; '>)</span><span style='color:#d2cd86; '>.</span><span style='color:#e66170; font-weight:bold; '>select</span><span style='color:#b060b0; '>{</span><span style='color:#d2cd86; '>|</span>l<span style='color:#d2cd86; '>|</span> l<span style='color:#d2cd86; '>.</span>include<span style='color:#b060b0; '>?</span> <span style='color:#02d045; '>"</span><span style='color:#00c4c4; '>2047:ffe7</span><span style='color:#02d045; '>"</span><span style='color:#b060b0; '>}</span><span style='color:#d2cd86; '>.</span>count <span style='color:#d2cd86; '>=</span><span style='color:#d2cd86; '>=</span> <span style='color:#008c00; '>0</span>
  <span style='color:#e66170; font-weight:bold; '>raise</span> <span style='color:#02d045; '>"</span><span style='color:#00c4c4; '>Boogie Board Rip not currently connected</span><span style='color:#02d045; '>"</span>
  end
  
  begin
  dmesg <span style='color:#d2cd86; '>=</span> `dmesg`
  bbdev <span style='color:#d2cd86; '>=</span> dmesg<span style='color:#d2cd86; '>.</span>split<span style='color:#d2cd86; '>(</span><span style='color:#02d045; '>"</span><span style='color:#008080; '>\n</span><span style='color:#02d045; '>"</span><span style='color:#d2cd86; '>)</span><span style='color:#d2cd86; '>.</span><span style='color:#e66170; font-weight:bold; '>select</span><span style='color:#b060b0; '>{</span><span style='color:#d2cd86; '>|</span>l<span style='color:#d2cd86; '>|</span> l<span style='color:#d2cd86; '>.</span>match <span style='color:#02d045; '>"</span><span style='color:#00c4c4; '>2047:FFE7.*hidraw[0-9]</span><span style='color:#02d045; '>"</span><span style='color:#b060b0; '>}</span><span style='color:#d2cd86; '>.</span>pop<span style='color:#d2cd86; '>.</span>match<span style='color:#d2cd86; '>(</span><span style='color:#02d045; '>"</span><span style='color:#00c4c4; '>(hidraw[0-9]+)</span><span style='color:#02d045; '>"</span><span style='color:#d2cd86; '>)</span><span style='color:#d2cd86; '>.</span>to_s
  <span style='color:#e66170; font-weight:bold; '>raise</span> RuntimeError <span style='color:#e66170; font-weight:bold; '>if</span> bbdev<span style='color:#d2cd86; '>.</span>empty<span style='color:#b060b0; '>?</span>
  rescue NoMethodError<span style='color:#d2cd86; '>,</span> RuntimeError
  <span style='color:#e66170; font-weight:bold; '>raise</span> <span style='color:#02d045; '>"</span><span style='color:#00c4c4; '>Boogie Board Rip detected, but device's path could not be determined</span><span style='color:#02d045; '>"</span>
  end
  
  events <span style='color:#d2cd86; '>=</span> <span style='color:#d2cd86; '>[</span><span style='color:#d2cd86; '>]</span>
  threads <span style='color:#d2cd86; '>=</span> <span style='color:#d2cd86; '>[</span><span style='color:#d2cd86; '>]</span>
  
  thread <span style='color:#d2cd86; '>=</span> Thread<span style='color:#d2cd86; '>.</span>new <span style='color:#e66170; font-weight:bold; '>do</span>
  board <span style='color:#d2cd86; '>=</span> File<span style='color:#d2cd86; '>.</span>new<span style='color:#d2cd86; '>(</span><span style='color:#02d045; '>"</span><span style='color:#00c4c4; '>/dev/</span><span style='color:#02d045; '>"</span><span style='color:#d2cd86; '>+</span>bbdev<span style='color:#d2cd86; '>,</span> <span style='color:#00c4c4; '>'r'</span><span style='color:#d2cd86; '>)</span>
  <span style='color:#e66170; font-weight:bold; '>while</span> true <span style='color:#e66170; font-weight:bold; '>do</span>
  data <span style='color:#d2cd86; '>=</span> board<span style='color:#d2cd86; '>.</span>sysread<span style='color:#d2cd86; '>(</span><span style='color:#008c00; '>32</span><span style='color:#d2cd86; '>)</span>
  event <span style='color:#d2cd86; '>=</span> Array<span style='color:#d2cd86; '>.</span>new<span style='color:#d2cd86; '>(</span><span style='color:#d2cd86; '>)</span>
  data<span style='color:#d2cd86; '>.</span>bytes <span style='color:#b060b0; '>{</span> <span style='color:#d2cd86; '>|</span>b<span style='color:#d2cd86; '>|</span> event <span style='color:#d2cd86; '>&lt;</span><span style='color:#d2cd86; '>&lt;</span> b <span style='color:#b060b0; '>}</span>
  events <span style='color:#d2cd86; '>&lt;</span><span style='color:#d2cd86; '>&lt;</span> event
  end
  end
  threads <span style='color:#d2cd86; '>&lt;</span><span style='color:#d2cd86; '>&lt;</span> thread
  
  thread <span style='color:#d2cd86; '>=</span> Thread<span style='color:#d2cd86; '>.</span>new <span style='color:#e66170; font-weight:bold; '>do</span>
  previous <span style='color:#d2cd86; '>=</span> Array<span style='color:#d2cd86; '>.</span>new<span style='color:#d2cd86; '>(</span><span style='color:#008c00; '>32</span><span style='color:#d2cd86; '>,</span> <span style='color:#008c00; '>0</span><span style='color:#d2cd86; '>)</span>
  current <span style='color:#d2cd86; '>=</span> <span style='color:#d2cd86; '>[</span><span style='color:#d2cd86; '>]</span>
  <span style='color:#e66170; font-weight:bold; '>while</span> true <span style='color:#e66170; font-weight:bold; '>do</span>
  current <span style='color:#d2cd86; '>=</span> events<span style='color:#d2cd86; '>.</span>shift
  next <span style='color:#e66170; font-weight:bold; '>if</span> current<span style='color:#d2cd86; '>.</span>nil<span style='color:#b060b0; '>?</span>
  
  <span style='color:#e66170; font-weight:bold; '>if</span> current<span style='color:#d2cd86; '>[</span><span style='color:#008c00; '>10</span><span style='color:#d2cd86; '>]</span> <span style='color:#d2cd86; '>!</span><span style='color:#d2cd86; '>=</span> previous<span style='color:#d2cd86; '>[</span><span style='color:#008c00; '>10</span><span style='color:#d2cd86; '>]</span>
  state <span style='color:#d2cd86; '>=</span> current<span style='color:#d2cd86; '>[</span><span style='color:#008c00; '>10</span><span style='color:#d2cd86; '>]</span>
  pstate <span style='color:#d2cd86; '>=</span> previous<span style='color:#d2cd86; '>[</span><span style='color:#008c00; '>10</span><span style='color:#d2cd86; '>]</span>
  lock <span style='color:#d2cd86; '>=</span> <span style='color:#008c00; '>32</span>
  erase <span style='color:#d2cd86; '>=</span> <span style='color:#008c00; '>4</span>
  wake <span style='color:#d2cd86; '>=</span> <span style='color:#008c00; '>2</span>
  <span style='color:#e66170; font-weight:bold; '>if</span> <span style='color:#d2cd86; '>(</span>pstate <span style='color:#d2cd86; '>=</span><span style='color:#d2cd86; '>=</span> pstate <span style='color:#d2cd86; '>|</span> lock<span style='color:#d2cd86; '>)</span> <span style='color:#d2cd86; '>&amp;</span><span style='color:#d2cd86; '>&amp;</span> <span style='color:#d2cd86; '>(</span>state <span style='color:#d2cd86; '>!</span><span style='color:#d2cd86; '>=</span> state <span style='color:#d2cd86; '>|</span> lock<span style='color:#d2cd86; '>)</span>
  <span style='color:#e66170; font-weight:bold; '>puts</span> <span style='color:#02d045; '>"</span><span style='color:#00c4c4; '>Board unlocked</span><span style='color:#02d045; '>"</span>
  elsif <span style='color:#d2cd86; '>(</span>pstate <span style='color:#d2cd86; '>!</span><span style='color:#d2cd86; '>=</span> pstate <span style='color:#d2cd86; '>|</span> lock<span style='color:#d2cd86; '>)</span> <span style='color:#d2cd86; '>&amp;</span><span style='color:#d2cd86; '>&amp;</span> <span style='color:#d2cd86; '>(</span>state <span style='color:#d2cd86; '>=</span><span style='color:#d2cd86; '>=</span> state <span style='color:#d2cd86; '>|</span> lock<span style='color:#d2cd86; '>)</span>
  <span style='color:#e66170; font-weight:bold; '>puts</span> <span style='color:#02d045; '>"</span><span style='color:#00c4c4; '>Board locked</span><span style='color:#02d045; '>"</span>
  end
  <span style='color:#e66170; font-weight:bold; '>if</span> <span style='color:#d2cd86; '>(</span>pstate <span style='color:#d2cd86; '>=</span><span style='color:#d2cd86; '>=</span> pstate <span style='color:#d2cd86; '>|</span> erase<span style='color:#d2cd86; '>)</span> <span style='color:#d2cd86; '>&amp;</span><span style='color:#d2cd86; '>&amp;</span> <span style='color:#d2cd86; '>(</span>state <span style='color:#d2cd86; '>!</span><span style='color:#d2cd86; '>=</span> state <span style='color:#d2cd86; '>|</span> erase<span style='color:#d2cd86; '>)</span>
  <span style='color:#e66170; font-weight:bold; '>puts</span> <span style='color:#02d045; '>"</span><span style='color:#00c4c4; '>Erase released</span><span style='color:#02d045; '>"</span>
  elsif <span style='color:#d2cd86; '>(</span>pstate <span style='color:#d2cd86; '>!</span><span style='color:#d2cd86; '>=</span> pstate <span style='color:#d2cd86; '>|</span> erase<span style='color:#d2cd86; '>)</span> <span style='color:#d2cd86; '>&amp;</span><span style='color:#d2cd86; '>&amp;</span> <span style='color:#d2cd86; '>(</span>state <span style='color:#d2cd86; '>=</span><span style='color:#d2cd86; '>=</span> state <span style='color:#d2cd86; '>|</span> erase<span style='color:#d2cd86; '>)</span>
  <span style='color:#e66170; font-weight:bold; '>puts</span> <span style='color:#02d045; '>"</span><span style='color:#00c4c4; '>Erase Pressed</span><span style='color:#02d045; '>"</span>
  end
  <span style='color:#e66170; font-weight:bold; '>if</span> <span style='color:#d2cd86; '>(</span>pstate <span style='color:#d2cd86; '>=</span><span style='color:#d2cd86; '>=</span> pstate <span style='color:#d2cd86; '>|</span> wake<span style='color:#d2cd86; '>)</span> <span style='color:#d2cd86; '>&amp;</span><span style='color:#d2cd86; '>&amp;</span> <span style='color:#d2cd86; '>(</span>state <span style='color:#d2cd86; '>!</span><span style='color:#d2cd86; '>=</span> state <span style='color:#d2cd86; '>|</span> wake<span style='color:#d2cd86; '>)</span>
  <span style='color:#e66170; font-weight:bold; '>puts</span> <span style='color:#02d045; '>"</span><span style='color:#00c4c4; '>Wake released</span><span style='color:#02d045; '>"</span>
  elsif <span style='color:#d2cd86; '>(</span>pstate <span style='color:#d2cd86; '>!</span><span style='color:#d2cd86; '>=</span> pstate <span style='color:#d2cd86; '>|</span> wake<span style='color:#d2cd86; '>)</span> <span style='color:#d2cd86; '>&amp;</span><span style='color:#d2cd86; '>&amp;</span> <span style='color:#d2cd86; '>(</span>state <span style='color:#d2cd86; '>=</span><span style='color:#d2cd86; '>=</span> state <span style='color:#d2cd86; '>|</span> wake<span style='color:#d2cd86; '>)</span>
  <span style='color:#e66170; font-weight:bold; '>puts</span> <span style='color:#02d045; '>"</span><span style='color:#00c4c4; '>Wake Pressed</span><span style='color:#02d045; '>"</span>
  end
  end
  <span style='color:#e66170; font-weight:bold; '>if</span> current<span style='color:#d2cd86; '>[</span><span style='color:#008c00; '>3</span><span style='color:#d2cd86; '>]</span> <span style='color:#d2cd86; '>!</span><span style='color:#d2cd86; '>=</span> previous<span style='color:#d2cd86; '>[</span><span style='color:#008c00; '>3</span><span style='color:#d2cd86; '>]</span>
  state <span style='color:#d2cd86; '>=</span> current<span style='color:#d2cd86; '>[</span><span style='color:#008c00; '>3</span><span style='color:#d2cd86; '>]</span>
  pstate <span style='color:#d2cd86; '>=</span> previous<span style='color:#d2cd86; '>[</span><span style='color:#008c00; '>3</span><span style='color:#d2cd86; '>]</span>
  detected <span style='color:#d2cd86; '>=</span> <span style='color:#008c00; '>32</span>
  contact <span style='color:#d2cd86; '>=</span> <span style='color:#008c00; '>1</span>
  <span style='color:#e66170; font-weight:bold; '>if</span> <span style='color:#d2cd86; '>(</span>pstate <span style='color:#d2cd86; '>=</span><span style='color:#d2cd86; '>=</span> pstate <span style='color:#d2cd86; '>|</span> detected<span style='color:#d2cd86; '>)</span> <span style='color:#d2cd86; '>&amp;</span><span style='color:#d2cd86; '>&amp;</span> <span style='color:#d2cd86; '>(</span>state <span style='color:#d2cd86; '>!</span><span style='color:#d2cd86; '>=</span> state <span style='color:#d2cd86; '>|</span> detected<span style='color:#d2cd86; '>)</span>
  <span style='color:#e66170; font-weight:bold; '>puts</span> <span style='color:#02d045; '>"</span><span style='color:#00c4c4; '>Pen Lost</span><span style='color:#02d045; '>"</span>
  elsif <span style='color:#d2cd86; '>(</span>pstate <span style='color:#d2cd86; '>!</span><span style='color:#d2cd86; '>=</span> pstate <span style='color:#d2cd86; '>|</span> detected<span style='color:#d2cd86; '>)</span> <span style='color:#d2cd86; '>&amp;</span><span style='color:#d2cd86; '>&amp;</span> <span style='color:#d2cd86; '>(</span>state <span style='color:#d2cd86; '>=</span><span style='color:#d2cd86; '>=</span> state <span style='color:#d2cd86; '>|</span> detected<span style='color:#d2cd86; '>)</span>
  <span style='color:#e66170; font-weight:bold; '>puts</span> <span style='color:#02d045; '>"</span><span style='color:#00c4c4; '>Pen Detected</span><span style='color:#02d045; '>"</span>
  end
  <span style='color:#e66170; font-weight:bold; '>if</span> <span style='color:#d2cd86; '>(</span>pstate <span style='color:#d2cd86; '>=</span><span style='color:#d2cd86; '>=</span> pstate <span style='color:#d2cd86; '>|</span> contact<span style='color:#d2cd86; '>)</span> <span style='color:#d2cd86; '>&amp;</span><span style='color:#d2cd86; '>&amp;</span> <span style='color:#d2cd86; '>(</span>state <span style='color:#d2cd86; '>!</span><span style='color:#d2cd86; '>=</span> state <span style='color:#d2cd86; '>|</span> contact<span style='color:#d2cd86; '>)</span>
  <span style='color:#e66170; font-weight:bold; '>puts</span> <span style='color:#02d045; '>"</span><span style='color:#00c4c4; '>Pen contact lost</span><span style='color:#02d045; '>"</span>
  elsif <span style='color:#d2cd86; '>(</span>pstate <span style='color:#d2cd86; '>!</span><span style='color:#d2cd86; '>=</span> pstate <span style='color:#d2cd86; '>|</span> contact<span style='color:#d2cd86; '>)</span> <span style='color:#d2cd86; '>&amp;</span><span style='color:#d2cd86; '>&amp;</span> <span style='color:#d2cd86; '>(</span>state <span style='color:#d2cd86; '>=</span><span style='color:#d2cd86; '>=</span> state <span style='color:#d2cd86; '>|</span> contact<span style='color:#d2cd86; '>)</span>
  <span style='color:#e66170; font-weight:bold; '>puts</span> <span style='color:#02d045; '>"</span><span style='color:#00c4c4; '>Pen contact detected</span><span style='color:#02d045; '>"</span>
  end
  end
  cury <span style='color:#d2cd86; '>=</span> current<span style='color:#d2cd86; '>[</span><span style='color:#008c00; '>4</span><span style='color:#d2cd86; '>]</span><span style='color:#d2cd86; '>+</span><span style='color:#d2cd86; '>(</span>current<span style='color:#d2cd86; '>[</span><span style='color:#008c00; '>5</span><span style='color:#d2cd86; '>]</span><span style='color:#d2cd86; '>*</span><span style='color:#008c00; '>256</span><span style='color:#d2cd86; '>)</span>
  curx <span style='color:#d2cd86; '>=</span> current<span style='color:#d2cd86; '>[</span><span style='color:#008c00; '>6</span><span style='color:#d2cd86; '>]</span><span style='color:#d2cd86; '>+</span><span style='color:#d2cd86; '>(</span>current<span style='color:#d2cd86; '>[</span><span style='color:#008c00; '>7</span><span style='color:#d2cd86; '>]</span><span style='color:#d2cd86; '>*</span><span style='color:#008c00; '>256</span><span style='color:#d2cd86; '>)</span>
  prey <span style='color:#d2cd86; '>=</span> previous<span style='color:#d2cd86; '>[</span><span style='color:#008c00; '>4</span><span style='color:#d2cd86; '>]</span><span style='color:#d2cd86; '>+</span><span style='color:#d2cd86; '>(</span>previous<span style='color:#d2cd86; '>[</span><span style='color:#008c00; '>5</span><span style='color:#d2cd86; '>]</span><span style='color:#d2cd86; '>*</span><span style='color:#008c00; '>256</span><span style='color:#d2cd86; '>)</span>
  prex <span style='color:#d2cd86; '>=</span> previous<span style='color:#d2cd86; '>[</span><span style='color:#008c00; '>6</span><span style='color:#d2cd86; '>]</span><span style='color:#d2cd86; '>+</span><span style='color:#d2cd86; '>(</span>previous<span style='color:#d2cd86; '>[</span><span style='color:#008c00; '>7</span><span style='color:#d2cd86; '>]</span><span style='color:#d2cd86; '>*</span><span style='color:#008c00; '>256</span><span style='color:#d2cd86; '>)</span>
  <span style='color:#e66170; font-weight:bold; '>if</span> cury <span style='color:#d2cd86; '>!</span><span style='color:#d2cd86; '>=</span> prey <span style='color:#d2cd86; '>|</span><span style='color:#d2cd86; '>|</span> curx <span style='color:#d2cd86; '>!</span><span style='color:#d2cd86; '>=</span> prex
  <span style='color:#e66170; font-weight:bold; '>puts</span> <span style='color:#02d045; '>"</span><span style='color:#00c4c4; '>Pen moved from (</span><span style='color:#02d045; '>"</span><span style='color:#d2cd86; '>+</span>prex<span style='color:#d2cd86; '>.</span>to_s<span style='color:#d2cd86; '>+</span><span style='color:#02d045; '>"</span><span style='color:#00c4c4; '>,</span><span style='color:#02d045; '>"</span><span style='color:#d2cd86; '>+</span>prey<span style='color:#d2cd86; '>.</span>to_s<span style='color:#d2cd86; '>+</span><span style='color:#02d045; '>"</span><span style='color:#00c4c4; '>) to (</span><span style='color:#02d045; '>"</span><span style='color:#d2cd86; '>+</span>curx<span style='color:#d2cd86; '>.</span>to_s<span style='color:#d2cd86; '>+</span><span style='color:#02d045; '>"</span><span style='color:#00c4c4; '>,</span><span style='color:#02d045; '>"</span><span style='color:#d2cd86; '>+</span>cury<span style='color:#d2cd86; '>.</span>to_s<span style='color:#d2cd86; '>+</span><span style='color:#02d045; '>"</span><span style='color:#00c4c4; '>)</span><span style='color:#02d045; '>"</span>
  end
  previous <span style='color:#d2cd86; '>=</span> current
  end
  end
  threads <span style='color:#d2cd86; '>&lt;</span><span style='color:#d2cd86; '>&lt;</span> thread
  
  threads<span style='color:#d2cd86; '>.</span>each<span style='color:#b060b0; '>{</span> <span style='color:#d2cd86; '>|</span>thread<span style='color:#d2cd86; '>|</span> thread<span style='color:#d2cd86; '>.</span>join<span style='color:#b060b0; '>}</span>
  
  rescue RuntimeError <span style='color:#d2cd86; '>=</span><span style='color:#d2cd86; '>></span> error
  <span style='color:#e66170; font-weight:bold; '>puts</span> error
  end
  </pre>
  
  
  It's very rudimentary at the moment, and needs to be run as root so the device can be accessed, but hopefully with a bit more hacking I'll be able to get something graphical up and running.  It also strikes me that you should be able to use the Boogie Board like a Wacom tablet if someone would be good enough to write a device driver. It's a bit beyond me but the information's pretty much all there in the script!
layout: post
permalink: /2012/01/boogie-board-rip-on-linux/
---
I&#8217;m fed up of making notes on scrappy bits of paper that I lose, so with some money I got for Christmas I got myself a [Boogie Board Rip](http://www.amazon.co.uk/gp/product/B005ZPZ5XW/ref=as_li_qf_sp_asin_il_tl?ie=UTF8&tag=barrfrozwast-21&linkCode=as2&camp=1634&creative=6738&creativeASIN=B005ZPZ5XW). I&#8217;m not going to do a full-blown review here, but essentially it&#8217;s an etch-a-sketch on top of a portable graphics tablet. The graphics tablet bit is battery powered, and converts what you draw to PDF. The PDFs can be accessed by plugging the board into a PC via a Micro USB cable. Some people complain that it&#8217;s not very good for drawing, but I only wanted it for writing and it&#8217;s great for that.

After using the board for a couple of days, it turns out that as well as appearing as a USB storage device when plugged in, it also appears as a human interface device and spits out a stream of binary (32 bytes of it to be exact) for each event that occurs on the device (button presses, movement of the stylus, etc). With a bit of help from the aforementioned blog post I&#8217;ve managed to decode the binary and write a short Ruby script that reports what&#8217;s happened each time you do something.

The script as it stands at time of posting is shown below. The latest version is available on [github](https://github.com/marxjohnson/rubyboard).

<pre style='color:#d1d1d1;background:#000000;'>begin
    lsusb <span style='color:#d2cd86; '>=</span> `lsusb`
    <span style='color:#e66170; font-weight:bold; '>if</span> lsusb<span style='color:#d2cd86; '>.</span>split<span style='color:#d2cd86; '>(</span><span style='color:#02d045; '>"</span><span style='color:#008080; '>\n</span><span style='color:#02d045; '>"</span><span style='color:#d2cd86; '>)</span><span style='color:#d2cd86; '>.</span><span style='color:#e66170; font-weight:bold; '>select</span><span style='color:#b060b0; '>{</span><span style='color:#d2cd86; '>|</span>l<span style='color:#d2cd86; '>|</span> l<span style='color:#d2cd86; '>.</span>include<span style='color:#b060b0; '>?</span> <span style='color:#02d045; '>"</span><span style='color:#00c4c4; '>2047:ffe7</span><span style='color:#02d045; '>"</span><span style='color:#b060b0; '>}</span><span style='color:#d2cd86; '>.</span>count <span style='color:#d2cd86; '>=</span><span style='color:#d2cd86; '>=</span> <span style='color:#008c00; '></span>
        <span style='color:#e66170; font-weight:bold; '>raise</span> <span style='color:#02d045; '>"</span><span style='color:#00c4c4; '>Boogie Board Rip not currently connected</span><span style='color:#02d045; '>"</span>
    end

    begin
        dmesg <span style='color:#d2cd86; '>=</span> `dmesg`
        bbdev <span style='color:#d2cd86; '>=</span> dmesg<span style='color:#d2cd86; '>.</span>split<span style='color:#d2cd86; '>(</span><span style='color:#02d045; '>"</span><span style='color:#008080; '>\n</span><span style='color:#02d045; '>"</span><span style='color:#d2cd86; '>)</span><span style='color:#d2cd86; '>.</span><span style='color:#e66170; font-weight:bold; '>select</span><span style='color:#b060b0; '>{</span><span style='color:#d2cd86; '>|</span>l<span style='color:#d2cd86; '>|</span> l<span style='color:#d2cd86; '>.</span>match <span style='color:#02d045; '>"</span><span style='color:#00c4c4; '>2047:FFE7.*hidraw[0-9]</span><span style='color:#02d045; '>"</span><span style='color:#b060b0; '>}</span><span style='color:#d2cd86; '>.</span>pop<span style='color:#d2cd86; '>.</span>match<span style='color:#d2cd86; '>(</span><span style='color:#02d045; '>"</span><span style='color:#00c4c4; '>(hidraw[0-9]+)</span><span style='color:#02d045; '>"</span><span style='color:#d2cd86; '>)</span><span style='color:#d2cd86; '>.</span>to_s
        <span style='color:#e66170; font-weight:bold; '>raise</span> RuntimeError <span style='color:#e66170; font-weight:bold; '>if</span> bbdev<span style='color:#d2cd86; '>.</span>empty<span style='color:#b060b0; '>?</span> 
    rescue NoMethodError<span style='color:#d2cd86; '>,</span> RuntimeError
        <span style='color:#e66170; font-weight:bold; '>raise</span> <span style='color:#02d045; '>"</span><span style='color:#00c4c4; '>Boogie Board Rip detected, but device's path could not be determined</span><span style='color:#02d045; '>"</span>
    end

    events <span style='color:#d2cd86; '>=</span> <span style='color:#d2cd86; '>[</span><span style='color:#d2cd86; '>]</span>
    threads <span style='color:#d2cd86; '>=</span> <span style='color:#d2cd86; '>[</span><span style='color:#d2cd86; '>]</span>

    thread <span style='color:#d2cd86; '>=</span> Thread<span style='color:#d2cd86; '>.</span>new <span style='color:#e66170; font-weight:bold; '>do</span>
        board <span style='color:#d2cd86; '>=</span> File<span style='color:#d2cd86; '>.</span>new<span style='color:#d2cd86; '>(</span><span style='color:#02d045; '>"</span><span style='color:#00c4c4; '>/dev/</span><span style='color:#02d045; '>"</span><span style='color:#d2cd86; '>+</span>bbdev<span style='color:#d2cd86; '>,</span> <span style='color:#00c4c4; '>'r'</span><span style='color:#d2cd86; '>)</span>
        <span style='color:#e66170; font-weight:bold; '>while</span> true <span style='color:#e66170; font-weight:bold; '>do</span>
            data <span style='color:#d2cd86; '>=</span> board<span style='color:#d2cd86; '>.</span>sysread<span style='color:#d2cd86; '>(</span><span style='color:#008c00; '>32</span><span style='color:#d2cd86; '>)</span>
            event <span style='color:#d2cd86; '>=</span> Array<span style='color:#d2cd86; '>.</span>new<span style='color:#d2cd86; '>(</span><span style='color:#d2cd86; '>)</span>
            data<span style='color:#d2cd86; '>.</span>bytes <span style='color:#b060b0; '>{</span> <span style='color:#d2cd86; '>|</span>b<span style='color:#d2cd86; '>|</span> event <span style='color:#d2cd86; '>&lt;</span><span style='color:#d2cd86; '>&lt;</span> b <span style='color:#b060b0; '>}</span>
            events <span style='color:#d2cd86; '>&lt;</span><span style='color:#d2cd86; '>&lt;</span> event
        end
    end
    threads <span style='color:#d2cd86; '>&lt;</span><span style='color:#d2cd86; '>&lt;</span> thread

    thread <span style='color:#d2cd86; '>=</span> Thread<span style='color:#d2cd86; '>.</span>new <span style='color:#e66170; font-weight:bold; '>do</span>
        previous <span style='color:#d2cd86; '>=</span> Array<span style='color:#d2cd86; '>.</span>new<span style='color:#d2cd86; '>(</span><span style='color:#008c00; '>32</span><span style='color:#d2cd86; '>,</span> <span style='color:#008c00; '></span><span style='color:#d2cd86; '>)</span>
        current <span style='color:#d2cd86; '>=</span> <span style='color:#d2cd86; '>[</span><span style='color:#d2cd86; '>]</span>
        <span style='color:#e66170; font-weight:bold; '>while</span> true <span style='color:#e66170; font-weight:bold; '>do</span>
            current <span style='color:#d2cd86; '>=</span> events<span style='color:#d2cd86; '>.</span>shift
            next <span style='color:#e66170; font-weight:bold; '>if</span> current<span style='color:#d2cd86; '>.</span>nil<span style='color:#b060b0; '>?</span>

            <span style='color:#e66170; font-weight:bold; '>if</span> current<span style='color:#d2cd86; '>[</span><span style='color:#008c00; '>10</span><span style='color:#d2cd86; '>]</span> <span style='color:#d2cd86; '>!</span><span style='color:#d2cd86; '>=</span> previous<span style='color:#d2cd86; '>[</span><span style='color:#008c00; '>10</span><span style='color:#d2cd86; '>]</span>
                state <span style='color:#d2cd86; '>=</span> current<span style='color:#d2cd86; '>[</span><span style='color:#008c00; '>10</span><span style='color:#d2cd86; '>]</span>
                pstate <span style='color:#d2cd86; '>=</span> previous<span style='color:#d2cd86; '>[</span><span style='color:#008c00; '>10</span><span style='color:#d2cd86; '>]</span>
                lock <span style='color:#d2cd86; '>=</span> <span style='color:#008c00; '>32</span>
                erase <span style='color:#d2cd86; '>=</span> <span style='color:#008c00; '>4</span>
                wake <span style='color:#d2cd86; '>=</span> <span style='color:#008c00; '>2</span>
                <span style='color:#e66170; font-weight:bold; '>if</span> <span style='color:#d2cd86; '>(</span>pstate <span style='color:#d2cd86; '>=</span><span style='color:#d2cd86; '>=</span> pstate <span style='color:#d2cd86; '>|</span> lock<span style='color:#d2cd86; '>)</span> <span style='color:#d2cd86; '>&</span><span style='color:#d2cd86; '>&</span> <span style='color:#d2cd86; '>(</span>state <span style='color:#d2cd86; '>!</span><span style='color:#d2cd86; '>=</span> state <span style='color:#d2cd86; '>|</span> lock<span style='color:#d2cd86; '>)</span>
                    <span style='color:#e66170; font-weight:bold; '>puts</span> <span style='color:#02d045; '>"</span><span style='color:#00c4c4; '>Board unlocked</span><span style='color:#02d045; '>"</span>
                elsif <span style='color:#d2cd86; '>(</span>pstate <span style='color:#d2cd86; '>!</span><span style='color:#d2cd86; '>=</span> pstate <span style='color:#d2cd86; '>|</span> lock<span style='color:#d2cd86; '>)</span> <span style='color:#d2cd86; '>&</span><span style='color:#d2cd86; '>&</span> <span style='color:#d2cd86; '>(</span>state <span style='color:#d2cd86; '>=</span><span style='color:#d2cd86; '>=</span> state <span style='color:#d2cd86; '>|</span> lock<span style='color:#d2cd86; '>)</span>
                    <span style='color:#e66170; font-weight:bold; '>puts</span> <span style='color:#02d045; '>"</span><span style='color:#00c4c4; '>Board locked</span><span style='color:#02d045; '>"</span>
                end
                <span style='color:#e66170; font-weight:bold; '>if</span> <span style='color:#d2cd86; '>(</span>pstate <span style='color:#d2cd86; '>=</span><span style='color:#d2cd86; '>=</span> pstate <span style='color:#d2cd86; '>|</span> erase<span style='color:#d2cd86; '>)</span> <span style='color:#d2cd86; '>&</span><span style='color:#d2cd86; '>&</span> <span style='color:#d2cd86; '>(</span>state <span style='color:#d2cd86; '>!</span><span style='color:#d2cd86; '>=</span> state <span style='color:#d2cd86; '>|</span> erase<span style='color:#d2cd86; '>)</span>
                    <span style='color:#e66170; font-weight:bold; '>puts</span> <span style='color:#02d045; '>"</span><span style='color:#00c4c4; '>Erase released</span><span style='color:#02d045; '>"</span>
                elsif <span style='color:#d2cd86; '>(</span>pstate <span style='color:#d2cd86; '>!</span><span style='color:#d2cd86; '>=</span> pstate <span style='color:#d2cd86; '>|</span> erase<span style='color:#d2cd86; '>)</span> <span style='color:#d2cd86; '>&</span><span style='color:#d2cd86; '>&</span> <span style='color:#d2cd86; '>(</span>state <span style='color:#d2cd86; '>=</span><span style='color:#d2cd86; '>=</span> state <span style='color:#d2cd86; '>|</span> erase<span style='color:#d2cd86; '>)</span>
                    <span style='color:#e66170; font-weight:bold; '>puts</span> <span style='color:#02d045; '>"</span><span style='color:#00c4c4; '>Erase Pressed</span><span style='color:#02d045; '>"</span>
                end
                <span style='color:#e66170; font-weight:bold; '>if</span> <span style='color:#d2cd86; '>(</span>pstate <span style='color:#d2cd86; '>=</span><span style='color:#d2cd86; '>=</span> pstate <span style='color:#d2cd86; '>|</span> wake<span style='color:#d2cd86; '>)</span> <span style='color:#d2cd86; '>&</span><span style='color:#d2cd86; '>&</span> <span style='color:#d2cd86; '>(</span>state <span style='color:#d2cd86; '>!</span><span style='color:#d2cd86; '>=</span> state <span style='color:#d2cd86; '>|</span> wake<span style='color:#d2cd86; '>)</span>
                    <span style='color:#e66170; font-weight:bold; '>puts</span> <span style='color:#02d045; '>"</span><span style='color:#00c4c4; '>Wake released</span><span style='color:#02d045; '>"</span>
                elsif <span style='color:#d2cd86; '>(</span>pstate <span style='color:#d2cd86; '>!</span><span style='color:#d2cd86; '>=</span> pstate <span style='color:#d2cd86; '>|</span> wake<span style='color:#d2cd86; '>)</span> <span style='color:#d2cd86; '>&</span><span style='color:#d2cd86; '>&</span> <span style='color:#d2cd86; '>(</span>state <span style='color:#d2cd86; '>=</span><span style='color:#d2cd86; '>=</span> state <span style='color:#d2cd86; '>|</span> wake<span style='color:#d2cd86; '>)</span>
                    <span style='color:#e66170; font-weight:bold; '>puts</span> <span style='color:#02d045; '>"</span><span style='color:#00c4c4; '>Wake Pressed</span><span style='color:#02d045; '>"</span>
                end
            end
            <span style='color:#e66170; font-weight:bold; '>if</span> current<span style='color:#d2cd86; '>[</span><span style='color:#008c00; '>3</span><span style='color:#d2cd86; '>]</span> <span style='color:#d2cd86; '>!</span><span style='color:#d2cd86; '>=</span> previous<span style='color:#d2cd86; '>[</span><span style='color:#008c00; '>3</span><span style='color:#d2cd86; '>]</span>
                state <span style='color:#d2cd86; '>=</span> current<span style='color:#d2cd86; '>[</span><span style='color:#008c00; '>3</span><span style='color:#d2cd86; '>]</span>
                pstate <span style='color:#d2cd86; '>=</span> previous<span style='color:#d2cd86; '>[</span><span style='color:#008c00; '>3</span><span style='color:#d2cd86; '>]</span>
                detected <span style='color:#d2cd86; '>=</span> <span style='color:#008c00; '>32</span>
                contact <span style='color:#d2cd86; '>=</span> <span style='color:#008c00; '>1</span>
                <span style='color:#e66170; font-weight:bold; '>if</span> <span style='color:#d2cd86; '>(</span>pstate <span style='color:#d2cd86; '>=</span><span style='color:#d2cd86; '>=</span> pstate <span style='color:#d2cd86; '>|</span> detected<span style='color:#d2cd86; '>)</span> <span style='color:#d2cd86; '>&</span><span style='color:#d2cd86; '>&</span> <span style='color:#d2cd86; '>(</span>state <span style='color:#d2cd86; '>!</span><span style='color:#d2cd86; '>=</span> state <span style='color:#d2cd86; '>|</span> detected<span style='color:#d2cd86; '>)</span>
                    <span style='color:#e66170; font-weight:bold; '>puts</span> <span style='color:#02d045; '>"</span><span style='color:#00c4c4; '>Pen Lost</span><span style='color:#02d045; '>"</span>
                elsif <span style='color:#d2cd86; '>(</span>pstate <span style='color:#d2cd86; '>!</span><span style='color:#d2cd86; '>=</span> pstate <span style='color:#d2cd86; '>|</span> detected<span style='color:#d2cd86; '>)</span> <span style='color:#d2cd86; '>&</span><span style='color:#d2cd86; '>&</span> <span style='color:#d2cd86; '>(</span>state <span style='color:#d2cd86; '>=</span><span style='color:#d2cd86; '>=</span> state <span style='color:#d2cd86; '>|</span> detected<span style='color:#d2cd86; '>)</span>
                    <span style='color:#e66170; font-weight:bold; '>puts</span> <span style='color:#02d045; '>"</span><span style='color:#00c4c4; '>Pen Detected</span><span style='color:#02d045; '>"</span>
                end
                <span style='color:#e66170; font-weight:bold; '>if</span> <span style='color:#d2cd86; '>(</span>pstate <span style='color:#d2cd86; '>=</span><span style='color:#d2cd86; '>=</span> pstate <span style='color:#d2cd86; '>|</span> contact<span style='color:#d2cd86; '>)</span> <span style='color:#d2cd86; '>&</span><span style='color:#d2cd86; '>&</span> <span style='color:#d2cd86; '>(</span>state <span style='color:#d2cd86; '>!</span><span style='color:#d2cd86; '>=</span> state <span style='color:#d2cd86; '>|</span> contact<span style='color:#d2cd86; '>)</span>
                    <span style='color:#e66170; font-weight:bold; '>puts</span> <span style='color:#02d045; '>"</span><span style='color:#00c4c4; '>Pen contact lost</span><span style='color:#02d045; '>"</span>
                elsif <span style='color:#d2cd86; '>(</span>pstate <span style='color:#d2cd86; '>!</span><span style='color:#d2cd86; '>=</span> pstate <span style='color:#d2cd86; '>|</span> contact<span style='color:#d2cd86; '>)</span> <span style='color:#d2cd86; '>&</span><span style='color:#d2cd86; '>&</span> <span style='color:#d2cd86; '>(</span>state <span style='color:#d2cd86; '>=</span><span style='color:#d2cd86; '>=</span> state <span style='color:#d2cd86; '>|</span> contact<span style='color:#d2cd86; '>)</span>
                    <span style='color:#e66170; font-weight:bold; '>puts</span> <span style='color:#02d045; '>"</span><span style='color:#00c4c4; '>Pen contact detected</span><span style='color:#02d045; '>"</span>
                end
            end
            cury <span style='color:#d2cd86; '>=</span> current<span style='color:#d2cd86; '>[</span><span style='color:#008c00; '>4</span><span style='color:#d2cd86; '>]</span><span style='color:#d2cd86; '>+</span><span style='color:#d2cd86; '>(</span>current<span style='color:#d2cd86; '>[</span><span style='color:#008c00; '>5</span><span style='color:#d2cd86; '>]</span><span style='color:#d2cd86; '>*</span><span style='color:#008c00; '>256</span><span style='color:#d2cd86; '>)</span>
            curx <span style='color:#d2cd86; '>=</span> current<span style='color:#d2cd86; '>[</span><span style='color:#008c00; '>6</span><span style='color:#d2cd86; '>]</span><span style='color:#d2cd86; '>+</span><span style='color:#d2cd86; '>(</span>current<span style='color:#d2cd86; '>[</span><span style='color:#008c00; '>7</span><span style='color:#d2cd86; '>]</span><span style='color:#d2cd86; '>*</span><span style='color:#008c00; '>256</span><span style='color:#d2cd86; '>)</span>
            prey <span style='color:#d2cd86; '>=</span> previous<span style='color:#d2cd86; '>[</span><span style='color:#008c00; '>4</span><span style='color:#d2cd86; '>]</span><span style='color:#d2cd86; '>+</span><span style='color:#d2cd86; '>(</span>previous<span style='color:#d2cd86; '>[</span><span style='color:#008c00; '>5</span><span style='color:#d2cd86; '>]</span><span style='color:#d2cd86; '>*</span><span style='color:#008c00; '>256</span><span style='color:#d2cd86; '>)</span>
            prex <span style='color:#d2cd86; '>=</span> previous<span style='color:#d2cd86; '>[</span><span style='color:#008c00; '>6</span><span style='color:#d2cd86; '>]</span><span style='color:#d2cd86; '>+</span><span style='color:#d2cd86; '>(</span>previous<span style='color:#d2cd86; '>[</span><span style='color:#008c00; '>7</span><span style='color:#d2cd86; '>]</span><span style='color:#d2cd86; '>*</span><span style='color:#008c00; '>256</span><span style='color:#d2cd86; '>)</span>
            <span style='color:#e66170; font-weight:bold; '>if</span> cury <span style='color:#d2cd86; '>!</span><span style='color:#d2cd86; '>=</span> prey <span style='color:#d2cd86; '>|</span><span style='color:#d2cd86; '>|</span> curx <span style='color:#d2cd86; '>!</span><span style='color:#d2cd86; '>=</span> prex
                <span style='color:#e66170; font-weight:bold; '>puts</span> <span style='color:#02d045; '>"</span><span style='color:#00c4c4; '>Pen moved from (</span><span style='color:#02d045; '>"</span><span style='color:#d2cd86; '>+</span>prex<span style='color:#d2cd86; '>.</span>to_s<span style='color:#d2cd86; '>+</span><span style='color:#02d045; '>"</span><span style='color:#00c4c4; '>,</span><span style='color:#02d045; '>"</span><span style='color:#d2cd86; '>+</span>prey<span style='color:#d2cd86; '>.</span>to_s<span style='color:#d2cd86; '>+</span><span style='color:#02d045; '>"</span><span style='color:#00c4c4; '>) to (</span><span style='color:#02d045; '>"</span><span style='color:#d2cd86; '>+</span>curx<span style='color:#d2cd86; '>.</span>to_s<span style='color:#d2cd86; '>+</span><span style='color:#02d045; '>"</span><span style='color:#00c4c4; '>,</span><span style='color:#02d045; '>"</span><span style='color:#d2cd86; '>+</span>cury<span style='color:#d2cd86; '>.</span>to_s<span style='color:#d2cd86; '>+</span><span style='color:#02d045; '>"</span><span style='color:#00c4c4; '>)</span><span style='color:#02d045; '>"</span>
            end    
            previous <span style='color:#d2cd86; '>=</span> current
        end
    end
    threads <span style='color:#d2cd86; '>&lt;</span><span style='color:#d2cd86; '>&lt;</span> thread

    threads<span style='color:#d2cd86; '>.</span>each<span style='color:#b060b0; '>{</span> <span style='color:#d2cd86; '>|</span>thread<span style='color:#d2cd86; '>|</span> thread<span style='color:#d2cd86; '>.</span>join<span style='color:#b060b0; '>}</span>
    
rescue RuntimeError <span style='color:#d2cd86; '>=</span><span style='color:#d2cd86; '>></span> error
    <span style='color:#e66170; font-weight:bold; '>puts</span> error
end
</pre>

It&#8217;s very rudimentary at the moment, and needs to be run as root so the device can be accessed, but hopefully with a bit more hacking I&#8217;ll be able to get something graphical up and running. It also strikes me that you should be able to use the Boogie Board like a Wacom tablet if someone would be good enough to write a device driver. It&#8217;s a bit beyond me but the information&#8217;s pretty much all there in the script!
