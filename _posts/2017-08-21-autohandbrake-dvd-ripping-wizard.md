---
id: 340
title: 'AutoHandbrake &#8211; DVD ripping wizard'
date: 2017-08-21T15:59:54+00:00
author: mark
layout: post
guid: http://barrenfrozenwasteland.com/?p=340
permalink: /2017/08/autohandbrake-dvd-ripping-wizard/
---
This post is based on a talk a gave at [OggCamp](http://oggcamp.org) 17 in Canterbury last weekend.

At home I run an [Emby](https://emby.media/) server to store and stream my music and video libraries, primary to my living room PC which runs [Kodi](https://kodi.tv/). I’ve got a reasonably large DVD collection which contains an mixture of movies and TV episodes, which I wanted to rip and store on my Emby server. (Note, this post won’t go into the ethics or legality of ripping DVDs, it’s purely a technical discussion).

Currently, the state of the art for ripping and encoding video from a DVD on Linux is [Handbrake](https://handbrake.fr/). Handbrake looks like this:

[<img class="aligncenter wp-image-341 size-large" src="http://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb-hb-1024x738.png" alt="Screenshot of the Handbrake GUI" width="800" height="577" srcset="https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb-hb-1024x738.png 1024w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb-hb-300x216.png 300w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb-hb-768x554.png 768w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb-hb-208x150.png 208w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb-hb-150x108.png 150w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb-hb.png 1104w" sizes="(max-width: 800px) 100vw, 800px" />](http://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb-hb.png)

The process for ripping a DVD of TV episodes with Handbrake does something like this:

  1. Insert your DVD and let Handbrake scan it.
  2. Select the first title you want to rip.
  3. Select any subtitle tracks you want to include, and specify the subtitle mode (more in this later).
  4. If you want non-default encoding settings, select your encoding preset.
  5. Enter the name for the output file, including any episode numbers.
  6. Add it to the queue.
  7. Repeat all of the above steps for each episode on the DVD.
  8. Run all the jobs in the queue.
  9. Discover you forgot the change the episode number on one of the episodes and overwrote the previous file.

As you can see, doing this for a large number of DVDs is quite labour-intensive, and the Handbrake GUI doesn’t do you a lot of favours. Handbrake also includes a command-line interface which lets you specify all of the settings mentioned above as command-line arguments. However, this requires you know things like tile and subtitle track numbers for what you want to rip.

My solution to this has been to write AutoHandbrake (autohb for short). This is a tool written in Ruby, which uses HandbrakeCLI to find out what’s on a DVD, then present you with a series of questions, and generate HandbrakeCLI commands to rip all the titles you want with the same settings.

The first thing AutoHandbake does is work out what’s on the DVD. To do this, it extracts the list of titles, and performs some analysis of the number and duration. In the case of a movie, you usually have a single long title with the “main feature” flag set. In the case of a set of TV episodes, you usually have between 4 and 8 similar-length titles, along with one “main feature” title that is around the same length as the all the similar-length titles added together (this is the ‘Play All’ option). The script will try and work out which one it’s got, then tell you what it thinks and ask you if it’s correct.

[<img class="aligncenter wp-image-342 size-large" src="http://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb1-1024x584.png" alt="Screeshot of Auto Handbrake, with the text &quot;Single main feature found: Title 1 [41 minutes and 49 seconds]. Rip this feature?&quot;, options &quot;Yes&quot; and &quot;No&quot;" width="800" height="456" srcset="https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb1-1024x584.png 1024w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb1-300x171.png 300w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb1-768x438.png 768w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb1-250x143.png 250w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb1-150x86.png 150w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb1.png 1074w" sizes="(max-width: 800px) 100vw, 800px" />](http://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb1.png)In this case, the DVD contains a set of TV epsiodes, but the ‘Play All’ title isn’t marked as the main feature, so it’s decided the DVD contains a single feature. This is wrong, so selecting “No” will allow you to correct it.

[<img class="aligncenter wp-image-343 size-large" src="http://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb2-1024x584.png" alt="List of titles. The first 4 titles have the duration 41:49 and are all selected.  The rest of the titles have different durations and are not selected." width="800" height="456" srcset="https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb2-1024x584.png 1024w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb2-300x171.png 300w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb2-768x438.png 768w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb2-250x143.png 250w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb2-150x86.png 150w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb2.png 1074w" sizes="(max-width: 800px) 100vw, 800px" />](http://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb2.png)

Here we get a list of titles to select. The original iteration of AutoHandbrake simply presented command-line prompts, and you typed in the numbers of the titles you wanted. However, I now use a tool called xdialog (via the rdialog ruby gem), which lets you easily display a curses interface for the required prompts when you run from the command line (as I usually do). As an added bonus, if you’re running in a desktop session, you get a proper GUI instead, like this:

[<img class="aligncenter wp-image-351 size-full" src="http://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb10.png" alt="The same title list as the previous image, but with an X Windows interface instead of a curses interface." width="623" height="401" srcset="https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb10.png 623w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb10-300x193.png 300w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb10-233x150.png 233w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb10-150x97.png 150w" sizes="(max-width: 623px) 100vw, 623px" />](http://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb10.png)

Once we’ve selected the titles we want to rip, we want to choose which subtitles to use.

[<img class="aligncenter wp-image-344 size-large" src="http://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb3-1024x584.png" alt="AutoHandbrake prompt, question &quot;Add subtitles with default settings? (Language eng, Forced Only: yes, Burned in: yes)&quot;, options &quot;Yes&quot;, &quot;No&quot;." width="800" height="456" srcset="https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb3-1024x584.png 1024w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb3-300x171.png 300w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb3-768x438.png 768w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb3-250x143.png 250w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb3-150x86.png 150w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb3.png 1074w" sizes="(max-width: 800px) 100vw, 800px" />](http://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb3.png)

By default AutoHandbrake will try and autodetect subtitles in the default language. It will also rip use the “forced only” flag, (only include subtiltes where a character is speaking in a different language) and the “burned in” flag (encode the subtitle text directly onto the video, rather than just including the track in the file). It’s fine to accept these options, but for some reason auto-detecting subtitles requires handbrake to scan through the whole title and extra time. Answering “no” here lets us specify the track ourselves.

[<img class="aligncenter wp-image-345 size-large" src="http://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb4-1024x584.png" alt="List of subtitle tracks. 2 options with the text &quot;English&quot;, the first is selected." width="800" height="456" srcset="https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb4-1024x584.png 1024w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb4-300x171.png 300w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb4-768x438.png 768w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb4-250x143.png 250w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb4-150x86.png 150w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb4.png 1074w" sizes="(max-width: 800px) 100vw, 800px" />](http://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb4.png)

Sometimes you’ll have options for several languages. Often there are more than one “English” options. I always just choose the first one, and I’ve never had a problem.

[<img class="aligncenter wp-image-346 size-large" src="http://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb5-1024x584.png" alt="Text input, labelled &quot;Enter the title for file and folder naming&quot;, the content is &quot;Stargate Sg1&quot;" width="800" height="456" srcset="https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb5-1024x584.png 1024w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb5-300x171.png 300w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb5-768x438.png 768w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb5-250x143.png 250w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb5-150x86.png 150w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb5.png 1074w" sizes="(max-width: 800px) 100vw, 800px" />](http://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb5.png)Next we’re asked to enter a title. This will be used to name the destination folder for the ripped files, and the start of the filenames (the whole filename if we’re ripping a movie). The DVD has a “title” field in its metadata which will be used as the default value. Sometimes this is spot on, usually it just needs a bit of fixing, but sometimes it’s complete nonsense. I’ve also had some interesting results here; for example, the first “Star Trek” film in the alternative timeline has the DVD title as “Start Trek XI”.

[<img class="aligncenter wp-image-347 size-large" src="http://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb6-1024x584.png" alt="Text input, labelled &quot;Enter season number for episode naming (Leave blank for none)&quot;. Text entered is 10." width="800" height="456" srcset="https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb6-1024x584.png 1024w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb6-300x171.png 300w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb6-768x438.png 768w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb6-250x143.png 250w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb6-150x86.png 150w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb6.png 1074w" sizes="(max-width: 800px) 100vw, 800px" />](http://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb6.png)

If we’re ripping a set of epsiodes rather than a single movie, we’ll be asked for the season number. This will be appended to the file name in the format “S##”, so if we enter a number less than 10 it will have the leading 0 added.

[<img class="aligncenter wp-image-348 size-large" src="http://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb7-1024x584.png" alt="Text input, labelled &quot;Enter first number for episode naming&quot;, text entered is &quot;1&quot;" width="800" height="456" srcset="https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb7-1024x584.png 1024w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb7-300x171.png 300w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb7-768x438.png 768w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb7-250x143.png 250w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb7-150x86.png 150w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb7.png 1074w" sizes="(max-width: 800px) 100vw, 800px" />](http://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb7.png)

The final input is for the first episode number on the disc. If you have 4 episodes starting with episode 5, entering 5 here will auto-number the episodes 05, 06, 07 and 08. Combined with the title and season number, this gives us file names that looks like “Stargate SG-1 S10E02”.

[<img class="aligncenter wp-image-349 size-large" src="http://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb8-1024x584.png" alt="Prompt displaying a list of HandbrakeCLI commands to rip and encode 4 titles." width="800" height="456" srcset="https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb8-1024x584.png 1024w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb8-300x171.png 300w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb8-768x438.png 768w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb8-250x143.png 250w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb8-150x86.png 150w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb8.png 1074w" sizes="(max-width: 800px) 100vw, 800px" />](http://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb8.png)Now we’ve got our queue of HandbrakeCLI commands. We can check that we’ve selected the right options, and the generated titles are as we expected. Selecting “Yes” here will run the commands and rip the videos!

[<img class="aligncenter wp-image-350 size-large" src="http://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb9-1024x584.png" alt="Terminal window showing the output of the HandbrakeCLI command" width="800" height="456" srcset="https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb9-1024x584.png 1024w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb9-300x171.png 300w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb9-768x438.png 768w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb9-250x143.png 250w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb9-150x86.png 150w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb9.png 1074w" sizes="(max-width: 800px) 100vw, 800px" />](http://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb9.png)This part of the process could do with some improvement. Currently it drops us to the terminal at this point and we just see the output of HandbrakeCLI. This shows us the time left in the current tasks, but doesn’t really give us an idea of the overall progress. This currently only shows if you’ve run AutoHandbrake from the terminal, otherwise you wont see any output at this point and you just have to wait for it to finish. When its done, the DVD drive will automatically eject the disc.

[<img class="aligncenter wp-image-352 size-large" src="http://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb-h-1024x584.png" alt="Usage information for AutoHandbrake, listing the available command line options." width="800" height="456" srcset="https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb-h-1024x584.png 1024w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb-h-300x171.png 300w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb-h-768x438.png 768w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb-h-250x143.png 250w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb-h-150x86.png 150w, https://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb-h.png 1074w" sizes="(max-width: 800px) 100vw, 800px" />](http://barrenfrozenwasteland.com/wp-content/uploads/2017/08/autohb-h.png)There are several options that you can specify a when invoking AutoHandbrake. The input device and output directory are the only ones that are really required. If you know what you want to rip, the rest of the arguments allow you to specify things like the title and season number in the command, in which case it wont ask you for them later.

Another interesting option is “min-duration”. Some publisher will fill the DVD with junk titles of a few seconds long, presumably to make it harder to find what you want to rip. By specifying a minimum duration of a few minutes, you can have Autohandbrake ignore these shorter titles, giving you just the likely candidates to choose from.

You can see, download an contribute to [AutoHandbrake on Github](https://github.com/marxjohnson/AutoHandbrake/).